See lines 150-189 in model.py for the CG update mentioned in the main paper.
